{% extends "base.html" %}
{% load static %}
{% block content %}
    <link rel="stylesheet" href="{% static 'Css/style_cad_user.css' %}">

    <div class="infos" >    
        <form action="{% url 'cadastro' %}" method="post">
            {% csrf_token %}
            <div class="div-h1">
                <h1>Cadastro de Usuarios</h1>
            </div> 
            <div class="div-inputs">
                <div id="nome-field">
                    <input name= "nome" class="form-control-sm" type="text" placeholder="Nome:" required>
                </div>
                <div id="telefone-field">
                    <input name="telefone" class="form-control-sm" type="text" placeholder="Telefone:" oninput="mascaraTelefone(this)" maxlength="15" required>
                </div>
                <div id="inst-field">
                    <input name= "instEnsino" class="form-control-sm" type="text"placeholder="Instituicao de Ensino:" required>
                </div>
                <div id="email-field">
                    <input name= "email" class="form-control-sm" type="text"placeholder="Email:" required>
                </div>

                <div id="senhaDiv" style="display: block;">
                    <input name= "senha" class="form-control-sm" type="password"placeholder="Senha:" required>
                </div>
                
                <!--token para organizador-->
                <div id="tokenAcessoDiv" style="display: none;">
                    <input name="token_acesso" class="form-control-sm" type="text"placeholder="Token de acesso:" required>
                </div>
                <br>
                <div>
                    <label for="Tipo">Qual sua ocupação:</label><br>
                    <input name= "tipo" class="form-control-sm" type="radio" value="aluno">Aluno
                    <input name= "tipo" class="form-control-sm" type="radio" value="professor">Professor
                    <input name= "tipo" class="form-control-sm" type="radio" value="organizador">Organizador
                </div>

                


            </div>
            <div class="div-button">
                <button type="submit" class="btn-enviar">Enviar</button>
            </div>
        </form>
                <script>
                    document.addEventListener("DOMContentLoaded", function() {
                        const radios = document.querySelectorAll('input[name="tipo"]');
                        const tokenDiv = document.getElementById('tokenAcessoDiv');
                        const tokenInput = tokenDiv.querySelector('input');

                        // Ao carregar a página, corrigir o required
                        if (!document.querySelector('input[name="tipo"]:checked') || 
                            document.querySelector('input[name="tipo"]:checked').value !== "organizador") {
                            tokenDiv.style.display = 'none';
                            tokenInput.required = false;
                        }

                        radios.forEach(radio => {
                            radio.addEventListener('change', function() {
                                if (this.value === 'organizador') {
                                    tokenDiv.style.display = 'block';
                                    tokenInput.required = true;
                                } else {
                                    tokenDiv.style.display = 'none';
                                    tokenInput.required = false;
                                }
                            });
                        });
                    });
                </script>



                <script>
                    function mascaraTelefone(input) {
                        let valor = input.value.replace(/\D/g, ""); // Remove tudo que não é número

                        if (valor.length > 0) valor = "(" + valor;
                        if (valor.length > 3) valor = valor.slice(0, 3) + ") " + valor.slice(3);
                        if (valor.length > 10) valor = valor.slice(0, 10) + "-" + valor.slice(10, 14);

                        input.value = valor;
                    }
                </script>
        </div>
{% endblock content %}